<?xml version="1.0" encoding="UTF-8"?>
<s:Skin name="table" class="table data-grid-skin"  xmlns:c="es.components" xmlns:s="es.core">
    <s:Metadata>[HostComponent("es.components.DataGrid")]</s:Metadata>
    <s:Script>
        <![CDATA[
           import es.events.PaginationEvent;
           import es.core.Display;
           import es.core.Skin;

           [Syntax("javascript")]
           override protected function updateDisplayList()
           {
                super.updateDisplayList();
                var hostComponent:* = this.hostComponent;
                var radius:String= hostComponent.radius+'px';
                var table:Element =  this.element;
                table.style('borderRadius', radius );
                Element('thead > tr:first-child >th:first-child' , table).style('borderTopLeftRadius',radius );
                Element('thead > tr:first-child >th:last-child' , table).style('borderTopRightRadius',radius );
                Element('tfoot > tr:last-child >td:first-child' , table).style('borderBottomLeftRadius',radius );
                Element('tfoot > tr:last-child >td:last-child' , table).style('borderBottomRightRadius',radius );
                Element('td', this.foot).height( hostComponent.footHeight ); 
            }

            override protected function initializing()
            {
               
                var hostComponent:DataGrid = this.hostComponent;
                console.log( "===datagrid==", hostComponent.isNeedCreateSkin(), hostComponent );
                if( hostComponent.isNeedCreateSkin() )
                {

                    var dataSource:DataSource =  hostComponent.dataSource;
                    var body:Skin = this;
                    var dataProfile:String =  hostComponent.dataProfile;
                    pagination.dataSource = dataSource;

                    body.assign('rowHeight', hostComponent.rowHeight );
                    body.assign('headHeight', hostComponent.headHeight );
                    body.assign( dataProfile, [] );
                    body.assign( hostComponent.columnProfile, hostComponent.columns);
                    body.assign( hostComponent.columnProfile, hostComponent.columns );

                    dataSource.addEventListener(DataSourceEvent.SELECT, function (event:DataSourceEvent)
                    {
                        if ( !event.waiting )
                        {
                            body.assign( dataProfile , event.data);
                            body.display();
                        }
                    });
                    dataSource.select( pagination.current );
               }

               super.initializing();
            }

        ]]>
    </s:Script>
    <style file="DataGridStyle.less" />
    <thead id="@head">
        <tr>
            <:foreach name="columns" value="name" >
                <th style="height:{headHeight}px;line-height:{headHeight}px;">{name}<span></span></th>
            </:foreach>
        </tr>
    </thead>

    <tbody id="@body">
        <:foreach name="datalist" value="item">
            <tr>
                <:foreach name="columns" value="val" key="field">
                    <:switch condition="field">
                        <:case condition="name" break="true">
                            <td data-column="{field}" style="height:{rowHeight}px;line-height:{rowHeight}px;">
                                <input value="{{item[field]}}" style="height: 25px;" />
                            </td>
                        </:case>
                        <:default>
                            <td data-column="{field}" style="height:{rowHeight}px;line-height:{rowHeight}px;">{item[field]}</td>
                        </:default>
                    </:switch>
                </:foreach>
            </tr>
        </:foreach>
    </tbody>

    <tfoot id="@foot">
         <tr>
             <td colspan="3">
                 <c:Pagination id="@pagination" radius="3" async="@hostComponent.async">
                 </c:Pagination>
             </td>
         </tr>
    </tfoot>

</s:Skin>