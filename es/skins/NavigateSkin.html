<?xml version="1.0" encoding="UTF-8"?>
<s:Skin xmlns:s="es.core" class="navigate">
    <s:Metadata>[HostComponent("es.components.Navigate")]</s:Metadata>
    <s:Script>
    <![CDATA[

        import es.interfaces.IContainer;

        override protected function initializing()
        {
            var hostComponent:Navigate = this.hostComponent;
            var dataSource:DataSource =  hostComponent.dataSource;
            var dataProfile:String =  hostComponent.dataProfile;
            var container:Skin = this.container;
            container.variable( dataProfile, hostComponent );
            var viewport:IContainer = hostComponent.viewport;
            container.variable( "loadContent", function(item:Object){

                 if( viewport && item.content instanceof Class ){
                     var obj:Skin = Reflect.construct(null, item.content, [hostComponent] ) as Skin;
                     viewport.addChild( obj );
                 }
            });
            var current:* = hostComponent.current;
            if( typeof current !== "function" )
            {
                var key:* = current;
                current = function(item:Object,index:*){
                    if(index==key)return true;
                    if( item["link"] == key || item["label"] == key ) return true;
                    return new RegExp( key ).test( (String)item.link );
                };
            }

            container.variable( "current",  current );
            dataSource.addEventListener(DataSourceEvent.SELECT, function (event:DataSourceEvent)
            {
                if ( !event.waiting )
                {
                    container.variable( dataProfile , event.data );
                    container.display();
                }
            });
            dataSource.select(1);
        }
    ]]>
    </s:Script>
    <style file="NavigateStyle.less" />
    <s:Skin id="@container" name="ul" class="nav nav-pills">
        <s:template>
            <:foreach name="datalist" value="item" key="link">
                <:if condition="current(item,forIndex)">
                   <li role="presentation" class="active"><a href="{item.link}">{item.label}</a></li>
                   <:code>loadContent(item)</:code>
                <:else />
                    <li role="presentation"><a href="{item.link}">{item.label}</a></li>
                </:if>
            </:foreach>
        </s:template>
    </s:Skin>
</s:Skin>