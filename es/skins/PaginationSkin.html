<?xml version="1.0" encoding="UTF-8"?>
<s:Skin xmlns:s="es.core" class="pagination">
    <s:Metadata>[HostComponent("es.components.Pagination")]</s:Metadata>
    <![CDATA[


        import es.core.Display;


       /**
         * @private
         */
        private var _wheelTarget;


        /**
         * 获取侦听鼠标滚轮事件的目标对象
         * @returns {Element};
         */
        public function get wheelTarget():Display
        {
            return this._wheelTarget;
        }


        /**
         * 设置侦听鼠标滚轮事件的目标对象
         */
        public function set wheelTarget( value:Display )
        {
            var old = this._wheelTarget;
            if( old !== value && value )
            {
                this._wheelTarget = value;
                if (old)old.removeEventListener(MouseEvent.MOUSE_WHEEL);
                if( value )
                {
                    var host = this.hostComponent;
                    value.addEventListener(MouseEvent.MOUSE_WHEEL, function (e) {
                        e.preventDefault();
                        var page = host.current;
                        host.current = e.wheelDelta > 0 ? page + 1 : page - 1;
                    }, false, 0, this);
                }
            }
        }

       override protected function initializing()
       {
            var host = this.hostComponent;
            var profile = new RegExp( host.profile+'\\s*=\\s*(\\d+)');
            var _wheelTarget = host.wheelTarget;
            if( _wheelTarget ){
              this.wheelTarget = _wheelTarget;
            }
            this.addEventListener(MouseEvent.CLICK, function (e:MouseEvent)
            {
                if (Element.getNodeName(e.target) === 'a')
                {
                    e.preventDefault();
                    var url:String = Element(e.target).property('href');
                    var _profile:Array = url.match(profile);
                    var page:Number = parseInt(_profile ? _profile[1] : 0);
                    if(page > 0)
                    {
                        host.current = page;
                    }
                }
            });

       }

        override protected function updateDisplayList()
        {
             super.updateDisplayList();
             var hostComponent:Pagination = this.hostComponent;
             var _radius = hostComponent.radius;
             if(_radius>0)
             {
                Element('.link' , this.element ).style('borderRadius', _radius+'px' );
             }
        }
    ]]>

    <style>
        @radius:3px;
        @border:darken(@secondary, 8.5%);

        .pagination{
            width: 100%;
            height: auto;
        }
        .pagination li
        {
            list-style: none;
            display: inline-block;
            margin: 0px 3px;
            width: auto;
            float: left;
        }
        .pagination li.link{
            background-color: #ffffff;
            border: solid 1px @border;
           .border-radius( @radius, @radius,  @radius,  @radius);
        }
        .pagination li.link a{
            width: 22px;
            height: 22px;
            text-align:center;
        }
        .pagination li.current{
            background-color: @secondary;
        }
        .pagination li.current a{
            color: #46484c;
        }
        .pagination li a{
            text-decoration: none;
            cursor: pointer;
            text-align:center;
            display: inline-block;
            line-height: 22px;
            color: #46484c;
        }

    </style>

  <s:template>
      <li class="first">
          <a href="{url(first,profile)}">第一页</a>
      </li>
      <li class="prev">
          <a href="{url(prev,profile)}" class='{current===1?"disabled":""}'>上一页</a>
      </li>
      <:foreach name="link" value="val">
          <li class="link {val===current?'current':''}">
              <a href="{url(val,profile)}">{val}</a>
          </li>
      </:foreach>
      <li class="next">
          <a href="{url(next,profile)}">下一页</a>
      </li>
      <li class="last">
          <a href="{url(last,profile)}">最后页</a>
      </li>
  </s:template>

</s:Skin>