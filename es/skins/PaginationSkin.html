<?xml version="1.0" encoding="UTF-8"?>
<s:Skin xmlns:s="es.core" class="pagination">
    <s:Metadata>[HostComponent("es.components.Pagination")]</s:Metadata>
    <s:Script>
    <![CDATA[

        import es.core.Display;

       override protected function initializing()
       {
            var host:Pagination = this.hostComponent;
            var profile:RegExp = new RegExp( host.profile+'\\s*=\\s*(\\d+)');
            this.addEventListener(MouseEvent.CLICK, function (e:MouseEvent)
            {
                if ( host.async && Element.getNodeName(e.target) === 'a')
                {
                    e.preventDefault();
                    var url:String = Element(e.target).property('href');
                    var _profile:Array = url.match(profile);
                    var page:Number = parseInt(_profile ? _profile[1] : 0);
                    if(page > 0)
                    {
                        host.current = page;
                    }
                }
            });
       }

        override protected function updateDisplayList()
        {
             super.updateDisplayList();
             var hostComponent:Pagination = this.hostComponent;
             var _radius:int = hostComponent.radius;
             if(_radius>0)
             {
                Element('.link' , this.element ).style('borderRadius', _radius+'px' );
             }
        }
    ]]>
    </s:Script>
  <style file="PaginationStyle.less" />

  <s:Declare>
      const {url:Function,first:int,prev:int,next:int,last:int,profile:*,current:int=1,link:Array} = dataset;
  </s:Declare>

  <li class="first">
      <a href="{url(first,profile)}">第一页</a>
  </li>
  <li class="prev">
      <a href="{url(prev,profile)}" class='{current===1?"disabled":""}'>上一页</a>
  </li>
  <:foreach name="link" value="val">
      <li class="link {val==current?'current':''}">
          <a href="{url(val,profile)}">{val}</a>
      </li>
  </:foreach>
  <li class="next">
      <a href="{url(next,profile)}">下一页</a>
  </li>
  <li class="last">
      <a href="{url(last,profile)}">最后页</a>
  </li>
</s:Skin>